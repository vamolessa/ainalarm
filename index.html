<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Ainalarm</title>
	<link rel="stylesheet" href="styles.css">
</head>
<body>
	<script>
		//const ALERT_TIMEOUT = 10 * 1000;
		const ALERT_TIMEOUT = 7 * 60 * 1000;
		const BLINK_TIMEOUT = 500;

		const original_title = document.title;
		const alert_title = document.title + " (TA NA HORA!)";
		const alarm_audio = new Audio("alarm.mp3");

		let timeout = -1;
		let blink_timeout = -1;
		let blink_on = false;

		function onStart() {
			clearTimeout(timeout);
			timeout = setInterval(function() {
				console.log("TA HA NORA!!");

				clearTimeout(blink_timeout);
				document.title = alert_title;
				blink_timeout = setInterval(function () {
					document.title = blink_on ? alert_title : original_title;
					blink_on = !blink_on;
				}, BLINK_TIMEOUT);

				alarm_audio.play();
			}, ALERT_TIMEOUT);
		}

		window.onfocus = function() {
			clearTimeout(blink_timeout);
			document.title = original_title;

			alarm_audio.pause();
			alarm_audio.fastSeek(0);
		}
	</script>
	<img src="rainbow_cry.gif" />
	<button class="start" onclick=onStart();>Agora!</button>
	<span class="version">vers√£o 1.0</span>
</body>
</html>
